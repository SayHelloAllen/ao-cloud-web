<!DOCTYPE html>
<html style="overflow-x: auto; overflow-y: auto;">
<head>
<title>智能派单服务平台</title>
<meta name="renderer" content="webkit">	
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">	
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">	
<meta name="apple-mobile-web-app-status-bar-style" content="black">	
<meta name="apple-mobile-web-app-capable" content="yes">	
<meta name="format-detection" content="telephone=no">	
<link rel="shortcut icon" href="${request.contextPath}/statics/images/favicon.ico">
<link rel="shortcut icon" href="${request.contextPath}/statics/images/favicon.ico">
<link rel="Stylesheet" href="${request.contextPath}/statics/css/login.css" />
<link rel="stylesheet" href="${request.contextPath}/statics/css/bootstrap.min.css">
<script src="${request.contextPath}/statics/libs/jquery.min.js"></script>
<script>
 	$(function() {
		// 初始化轮播
		$("#myCarousel").carousel({
			interval : 3500,
			pause : 'none'
		});
	}); 
</script>
</head>
<body>
	<div class="login-content" id="rrapp"  v-cloak>
		<!-- 登录页头部  start  -->
		<div class="loginhead">
			<div class="loginleft">
				<img src='${request.contextPath}/statics/images/logo.jpg' class="login-img"></img>
			</div>
			<div class="loginright">
				<div class="telphon">
					<i class="icon-phone"></i> 400-992-8251
				</div>
				<div class="longofont">工作时间:8:30-17:30</div>
			</div>
		</div>
		<!-- 登录页头部  end -->  
		 
		 
		<!-- 内容部分 -->
		<div class="login-lunbo">
			<!-- 轮播 -->
			<div id="myCarousel" class="carousel slide">
				<div class="carousel-inner">
					<div class="item active">
						<img src='${request.contextPath}/statics/images/bg1.png'>
					</div>
					<div class="item">
						<img src='${request.contextPath}/statics/images/bg2.png'>
					</div>
				</div>
			</div>
			<!-- 红色标题 -->
<!-- 			<div class="login-luntop">
				<img src='${request.contextPath}/statics/images/bg4.png'>
			</div>
			  -->
      
			<!-- 登录功能 -->
			<div class="login-deng">
				<form id="loginForm" class="login_form" method="post">
					<!-- logo -->
					<div class="login_logo">
						<img class="heading-img"
							src='${request.contextPath}/statics/images/icon.png'>
					</div>
					<!-- 标题 -->
					<h1 class="login_title" style="margin-top: 0px;margin-bottom: 0px;" >AO派单平台</h1>
					<div class="form-div-top">
						<!-- 用户名 start-->
						<div class="login_item">
							<div class="login_item_sx login_icon">
								<img src='${request.contextPath}/statics/images/icon_user.png' width="18px" height="21px">
							</div>
							<div class="login_item_sx login_input">
								<input type="text" name="username" style="border: none; outline: medium;" v-model="username"  class="input-block-level required l-login-input login_input_sx" placeholder="请输入登录账号">
							</div>
							<div></div>
						</div>
						<!-- 用户名 end-->
						
						<!-- 密码  start-->
						<div class="login_item">
							<div class="login_item_sx login_icon">
								<img src='${request.contextPath}/statics/images/icon_password.png' width="18px" height="21px">
							</div>
							<div class="login_item_sx login_input">
								<input type="password" v-model="password" style="border: none; outline: medium;" placeholder="请输入登录密码" class="input-block-level required l-login-input login_input_sx ">
							</div>
							<div></div>
						</div>
						<!-- 密码  end-->
						
						<!-- 验证码  start-->
						<div class="login_item">
							<div class="login_item_sx login_icon">
								<img src='${request.contextPath}/statics/images/icon_password.png' width="18px" height="21px">
							</div>
							<div class="login_item_sx login_input">
								<input type="text" style="border: none; outline: medium;" v-model="captcha" @keyup.enter="login" placeholder="验证码" class="input-block-level required l-login-input login_input_sx ">
							</div>
						    <div  class="login_item_sx login_input" style="margin-top:20px;margin-bottom:20px" >
						        <img alt="如果看不清楚，请单击图片刷新！" width ="40%" height="30px" class="pointer" :src="src" @click="refreshCode">						     
						        <a href="javascript:;"  @click="refreshCode">点击刷新</a>
						    </div>							
						</div>
						<!-- 验证码  end-->

						<div class="l-login-submit">
							<input class="btn btn-large" type="submit" value="登录" @click="login" />
						</div>
					    <div v-if="error"  >
				       		 <p style="width:100px;color:red"> {{errorMsg}}</p>
				        </div>
						
					</div>
				</form>
			</div>
		</div>
		<!-- 登录尾部 -->
		<div class="footer navbar-fixed-bottom">Copyright © zkh360.com 1998-2018 Corporation All Rights Reserved 沪ICP备10006078号-5</div>
	</div>
<script src="${request.contextPath}/statics/libs/vue.min.js"></script>
<script src="${request.contextPath}/statics/libs/bootstrap.min.js"></script>
<script src="${request.contextPath}/statics/libs/app.js"></script>
<script type="text/javascript">
var vm = new Vue({
	el:'#rrapp',
	data:{
		username: '',
		password: '',
		captcha: '',
		error: false,
		errorMsg: '',
		src: 'captcha.jpg'
	},
	beforeCreate: function(){
		if(self != top){
			top.location.href = self.location.href;
		}
	},
	methods: {
		refreshCode: function(){
			this.src = "captcha.jpg?t=" + $.now();
		},
		login: function (event) {
			var data = "username="+vm.username+"&password="+vm.password+"&captcha="+vm.captcha;
			$.ajax({
				type: "POST",
			    url: "sys/login",
			    data: data,
			    dataType: "json",
			    success: function(result){
					if(result.code == 0){//登录成功
						parent.location.href ='index.html';
					}else{
						vm.error = true;
						vm.errorMsg = result.msg;						
						vm.refreshCode();
					}
				}
			});
		}
	}
});
</script>
</body>
</html>